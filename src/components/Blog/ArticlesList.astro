---
import { getCollection } from "astro:content";
import Article from "./Article.astro";
import type { UIStrings } from "@i18n/dictionaries";
import type { Lang } from "@i18n/config";

interface ArticlesListProps {
  lang: Lang;
  copy: UIStrings["blogList"];
  articleReadLabel: string;
  dateLocale: string;
}

type Props = ArticlesListProps;

const { lang, copy, articleReadLabel, dateLocale } = Astro.props;

const articles = await getCollection("articles");
const sortedArticles = articles
  .filter((article) => article.data.lang === lang)
  .toSorted((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<section class="py-20 px-6 max-w-4xl mx-auto">
  <header class="text-center mb-12">
    <h2 class="text-3xl md:text-4xl font-light text-neutral-900 mb-4">
      {copy.title}
    </h2>
    <p class="text-lg text-neutral-600 max-w-2xl mx-auto leading-relaxed">
      {copy.description}
    </p>
  </header>

  <div class="space-y-8">
    {
      sortedArticles.map((article) => (
        <Article
          key={article.data.slug}
          date={article.data.date}
          excerpt={article.data.excerpt}
          slug={article.data.canonicalSlug}
          title={article.data.title}
          tags={article.data.tags}
          lang={lang}
          readLabel={articleReadLabel}
          dateLocale={dateLocale}
        />
      ))
    }
  </div>
</section>
